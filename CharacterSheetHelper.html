<!DOCTYPE html>
<html>
	<head>

		<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>

		<script> 
			var skills = new Array();
			var currentBackgroundSkills = new Array();
			var languagesKnown = new Array();
			var currentBackgroundLanguages = new Array();

		    $(function(){
		      $("#Header1").load("Header.html"); 
			  $("#PH_modules_list").load("Modules.html"); 
		    });

		    function addClass() {
		    	var span = '<span name="class">';

		    	span += $("span[name=class]").first().html();

		    	span = span.substring(0, span.indexOf('<br>'));

		    	span += "<button name=\"remove_but\" type=\"button\" onclick=\"removeClass(this)\">Remove</button>"

		    	span += "<br />"

		    	span += "</span>";


		    	$("#classes").append(span);

		    }

		    function removeClass(sender) {
		    	$(sender).parent().remove();
		    }

		    function calcMod(sender){

		    	var col = $("#statsTable tr").first().children().index($(sender).parent());

		    	var mod = parseInt($(sender).val()) || 0;
		    	mod = mod / 2;
		    	mod = mod - 5;
		    	mod = Math.floor(mod);


		    	switch (col) {
					case 0:
						$("#STRmod").html(mod);
						break;
					case 1:
						$("#DEXmod").html(mod);
						break;
					case 2:
						$("#CONmod").html(mod);
						break;
					case 3:
						$("#INTmod").html(mod);
						break;
					case 4:
						$("#WISmod").html(mod);
						break;
					case 5:
						$("#CHAmod").html(mod);
						break;
				}
		    }

		    function addAttack() {
		    	var row = "<tr>";
		    	row += '<td><input name="attName"></input></td>';
				row += '<td><input name="attBonus"></input></td>';
				row += '<td><input name="attType"></input></td>';
				row += '<td><input name="attDmg"></input></td>';
				row += '<td><input name="attDetails"></input></td>';
				row += '<td><button id="remove_but" type="button" onclick="removeAttack(this)">Remove</button></td>';
				row += '</tr>';

				$("#attacksTable").append(row);
		    }

		    function removeAttack(sender) {
		    	$(sender).parent().parent().remove();
		    }

		    function addFeat() {
		    	
		    }

		    function save() {
				var saveStr = new Object();

				saveStr["name"] = $("#charName").val();
				saveStr["background"] = $("#backgrounds").val();


				saveStr["alignment"] = $("input[name=alignment]:checked").val();


				if ($("#charRace").val() == "Custom") {
					saveStr["race"] = $("#charRaceCustom").val();
				} else {
					saveStr["race"] = $("#charRace").val();
				}

				saveStr["class"] = new Object();
				
				$("#classes").children().each(function (idx, itm) {
					var chaClass = $($(itm).children().get(1)).val();
					var chaLevel = $($(itm).children().get(3)).val();
					var chaClassRow = {class: chaClass, level: chaLevel};
					(saveStr["class"])[idx] = chaClassRow;
				});


				saveStr["proficiencies"] = new Array();
				saveStr["languages"] = new Array();

				$("#proficienciesList input:checked").each(function(idx, itm) {
					saveStr["proficiencies"].push($(itm).val());
				});
				
				$("#languagesList input:checked").each(function(idx, itm) {
					saveStr["languages"].push($(itm).val());
				});


				saveStr["statistics"] = JSON.stringify($("#statsTable").html());
				saveStr["attacks"] = JSON.stringify($("#attacksTable").html());

				alert("Copy and store this string:\n" + JSON.stringify(saveStr));
		    }

		    function load() {
		    	var loadStr = JSON.parse(window.prompt("Load","Enter saved string"));

				if (loadStr != null) {
					$("#charName").val(loadStr["name"]);
					$("#backgrounds").val(loadStr["background"]);


					$("input[value=" + loadStr["alignment"] + "]").prop('checked', true);


					$("#charRace").val(loadStr["race"]);


					$.each(loadStr["class"], function(idx, itm){
						if (idx > 0) {
							addClass();
						}
						$($($("#classes").children().get(idx)).children().get(1)).val(itm["class"]);
						$($($("#classes").children().get(idx)).children().get(3)).val(itm["level"]);
					});


					$("#proficienciesList input:checked").each(function(idx, itm) {
						$(itm).prop('checked', false);
					});
					$(loadStr["proficiencies"]).each(function(idx, itm) {
						$("input[name=proficiencies][value='" + itm + "']").prop('checked', true);
					});

					$("#languagesList input:checked").each(function(idx, itm) {
						$(itm).prop('checked', false);
					});
					$(loadStr["languages"]).each(function(idx, itm) {
						$("input[name=languages][value='" + itm + "']").prop('checked', true);
					});

					$($("#statsTable").get(0)).html(JSON.parse(loadStr["statistics"]));
					$($("#attacksTable").get(0)).html(JSON.parse(loadStr["attacks"]));

				}
		    }

		    function calcAC() {
		    	var value = $("#armour").val().split('-')

		    	var AC = parseInt(value[0]);

		    	if (value.length >= 2) {
		    		if (value[1] == "Dex") {
		    			var mod = $("#DEXmod").html();
		    			if (value.length = 3) {
		    				if (mod > value[2]) {
		    					mod = value[2];
		    				}
		    			}
	    				AC += parseInt(mod);
		    		}
		    	}

		    	$("#ac").html(AC);
		    }

		    function setBackground() {
		    	var background = $("#backgrounds").val();

		    	$(currentBackgroundSkills).each(function (idx, itm) {
		    		var index = skills.indexOf(itm);
		    		if (index > -1) {
						skills.splice(index, 1);
					}
		    	});

		    	$(currentBackgroundLanguages).each(function (idx, itm) {
		    		var index = languagesKnown.indexOf(itm);
		    		if (index > -1) {
						languagesKnown.splice(index, 1);
					}
		    	});

				$("#backgroundText").html("");		    	

		    	currentBackgroundSkills = [];
		    	currentBackgroundLanguages = [];
		    	if (background == "None") {
		    		setSkills();
		    		setLanguages();
		    	} else {
			    	$.get('backgrounds/' + background + '.txt', function(data) {
			    		var backgrounds = JSON.parse(data);
			    		$(backgrounds["Skills"]).each(function(idx, itm) {
			    			currentBackgroundSkills.push(itm);
			    		});

			    		$(backgrounds["Languanges"]).each(function(idx, itm) {
			    			currentBackgroundLanguages.push(itm);
			    		});


			    		fillBackgroundText(backgrounds);

			    		languagesKnown = languagesKnown.concat(currentBackgroundLanguages);
			    		skills = skills.concat(currentBackgroundSkills);
			    		setSkills();
			    		setLanguages();
			    	}, 'text');
		    	}
		    }

		    function setSkills() {
				$("#proficienciesList input").each(function (idx, itm) {
					$(itm).prop("checked", false);
				});

				var choose = 0;
		    	$(skills).each(function (idx, itm) {
		    		if (itm == "Choose") {
		    			choose += 1;
		    		} else {
		    			$("input[value='" + itm + "']").prop("checked", true);
		    		}
		    	});
		    	$("#profChoices").html("<br /> " + choose + " proficiencies choices")
		    	countSkillChoices();
		    }

		    function setLanguages() {
				$("#languagesList input").each(function (idx, itm) {
					$(itm).prop("checked", false);
				});

				var choose = 0;
		    	$(languagesKnown).each(function (idx, itm) {
		    		if (itm == "Choose") {
		    			choose += 1;
		    		} else {
		    			$("input[value='" + itm + "']").prop("checked", true);
		    		}
		    	});
		    	$("#langChoices").html("<br /> " + choose + " language choices")
		    	countLanguageChoices();
		    }

		    function countSkillChoices() {
		    	var count = 0;
		    	$("#proficienciesList input").each(function (idx, itm) {
					if (skills.indexOf($(itm).prop("value")) == -1 && $(itm).prop("checked") == true) {//this
						count ++;
					}
				});

				$("#profChosen").html("<br /> " + count + " proficiencies chosen")
		    }

		    function countLanguageChoices() {
		    	var count = 0;
		    	$("#languagesList input").each(function (idx, itm) {
					if (languagesKnown.indexOf($(itm).prop("value")) == -1 && $(itm).prop("checked") == true) {//this
						count ++;
					}
				});

				$("#langChosen").html("<br /> " + count + " languages chosen")
		    }

		    function fillBackgroundText(backgrounds) {
		    	var text = "Skill Proficiencies: " + backgrounds["Skills"].join(", ") + "<br />";
		    	text += "Tool Proficiencies: " + backgrounds["ToolProf"].join(", ") + "<br />";
		    	text += "Languages Known: " + backgrounds["Languanges"].join(", ") + "<br />";
		    	text += "Equipment: <br />" + backgrounds["Equipment"].join("") + "<br />";

		    	$("#backgroundText").html(text);
		    }

		    function exportChar(sender) {

		    	var charName = $("#charName").val();
		    	var charClass = $($("select[name=charClass]").first()).val();
		    	var charLevel = "level " + $($("#charLvl1").first()).val();
		    	var background = $("#backgrounds").val();
		    	var chaRace = $("#charRace").val();
		    	var alignment = $("input[name=alignment]:checked").val();
		    	var charStr = $("#charSTR").val();
		    	var charStrMod = $("#STRmod").html();
		    	var charDex = $("#charDEX").val();
		    	var charDexMod = $("#DEXmod").html();
		    	var charCon = $("#charCON").val();
		    	var charConMod = $("#CONmod").html();
		    	var charInt = $("#charINT").val();
		    	var charIntMod = $("#INTmod").html();
		    	var charWis = $("#charWIS").val();
		    	var charWisMod = $("#WISmod").html();
		    	var charCha = $("#charCHA").val();
				var charChaMod = $("#CHAmod").html();
				var profBonus = Math.floor((($($("#charLvl1").first()).val() - 1) / 4) + 2);
				var STRSaveCheck = (($("#charSTRsavethrow").prop("checked")) ? "Yes" : "Off");
				var DEXSaveCheck = (($("#charDEXsavethrow").prop("checked")) ? "Yes" : "Off");
				var CONSaveCheck = (($("#charCONsavethrow").prop("checked")) ? "Yes" : "Off");
				var INTSaveCheck = (($("#charINTsavethrow").prop("checked")) ? "Yes" : "Off");
				var WISSaveCheck = (($("#charWISsavethrow").prop("checked")) ? "Yes" : "Off");
				var CHASaveCheck = (($("#charCHAsavethrow").prop("checked")) ? "Yes" : "Off");
				var STRSave = ((STRSaveCheck == "Yes") ? parseInt(charStrMod) + parseInt(profBonus) : charStrMod);
				var DEXSave = ((DEXSaveCheck == "Yes") ? parseInt(charDexMod) + parseInt(profBonus) : charDexMod);
				var CONSave = ((CONSaveCheck == "Yes") ? parseInt(charConMod) + parseInt(profBonus) : charConMod);
				var INTSave = ((INTSaveCheck == "Yes") ? parseInt(charIntMod) + parseInt(profBonus) : charIntMod);
				var WISSave = ((WISSaveCheck == "Yes") ? parseInt(charWisMod) + parseInt(profBonus) : charWisMod);
				var CHASave = ((CHASaveCheck == "Yes") ? parseInt(charChaMod) + parseInt(profBonus) : charChaMod);
				var AcrobaticsProf = (($("#profAcrobatics").prop("checked")) ? "Yes" : "Off");
				var AnimalProf = (($("#profAnimalHandling").prop("checked")) ? "Yes" : "Off");
				var ArcanaProf = (($("#profArcana").prop("checked")) ? "Yes" : "Off");
				var AthleticsProf = (($("#profAthletics").prop("checked")) ? "Yes" : "Off");
				var DeceptionProf = (($("#profDeception").prop("checked")) ? "Yes" : "Off");
				var HistoryProf = (($("#profHistory").prop("checked")) ? "Yes" : "Off");
				var InsightProf = (($("#profInsight").prop("checked")) ? "Yes" : "Off");
				var IntimidationProf = (($("#profIntimidation").prop("checked")) ? "Yes" : "Off");
				var InvestigationProf = (($("#profInvestigation").prop("checked")) ? "Yes" : "Off");
				var MedicineProf = (($("#profMedicine").prop("checked")) ? "Yes" : "Off");
				var NatureProf = (($("#profNature").prop("checked")) ? "Yes" : "Off");
				var PerceptionProf = (($("#profPerception").prop("checked")) ? "Yes" : "Off");
				var PerformanceProf = (($("#profPerformance").prop("checked")) ? "Yes" : "Off");
				var PersuasionProf = (($("#profPersuasion").prop("checked")) ? "Yes" : "Off");
				var ReligionProf = (($("#profReligion").prop("checked")) ? "Yes" : "Off");
				var SleightProf = (($("#profSleightOfHand").prop("checked")) ? "Yes" : "Off");
				var StealthProf = (($("#profStealth").prop("checked")) ? "Yes" : "Off");
				var SurvivalProf = (($("#profSurvival").prop("checked")) ? "Yes" : "Off");
				var Acrobatics = ((STRSaveCheck == "Yes") ? parseInt(charDexMod) + parseInt(profBonus) : charDexMod);
				var Animal = ((DEXSaveCheck == "Yes") ? parseInt(charWisMod) + parseInt(profBonus) : charWisMod);
				var Arcana = ((CONSaveCheck == "Yes") ? parseInt(charIntMod) + parseInt(profBonus) : charIntMod);
				var Athletics = ((INTSaveCheck == "Yes") ? parseInt(charStrMod) + parseInt(profBonus) : charStrMod);
				var Deception = ((WISSaveCheck == "Yes") ? parseInt(charChaMod) + parseInt(profBonus) : charChaMod);
				var History = ((CHASaveCheck == "Yes") ? parseInt(charIntMod) + parseInt(profBonus) : charIntMod);
				var Insight = ((STRSaveCheck == "Yes") ? parseInt(charWisMod) + parseInt(profBonus) : charWisMod);
				var Intimidation = ((DEXSaveCheck == "Yes") ? parseInt(charChaMod) + parseInt(profBonus) : charChaMod);
				var Investigation = ((CONSaveCheck == "Yes") ? parseInt(charIntMod) + parseInt(profBonus) : charIntMod);
				var Medicine = ((INTSaveCheck == "Yes") ? parseInt(charWisMod) + parseInt(profBonus) : charWisMod);
				var Nature = ((WISSaveCheck == "Yes") ? parseInt(charIntMod) + parseInt(profBonus) : charIntMod);
				var Perception = ((CHASaveCheck == "Yes") ? parseInt(charWisMod) + parseInt(profBonus) : charWisMod);
				var Performance = ((STRSaveCheck == "Yes") ? parseInt(charChaMod) + parseInt(profBonus) : charChaMod);
				var Persuasion = ((DEXSaveCheck == "Yes") ? parseInt(charChaMod) + parseInt(profBonus) : charChaMod);
				var Religion = ((CONSaveCheck == "Yes") ? parseInt(charIntMod) + parseInt(profBonus) : charIntMod);
				var Sleight = ((INTSaveCheck == "Yes") ? parseInt(charDexMod) + parseInt(profBonus) : charDexMod);
				var Stealth = ((WISSaveCheck == "Yes") ? parseInt(charDexMod) + parseInt(profBonus) : charDexMod);
				var Survival = ((CHASaveCheck == "Yes") ? parseInt(charWisMod) + parseInt(profBonus) : charWisMod);
				var languages = (($("#langCommon").prop("checked")) ? "Common \n" : "");
				languages += (($("#langDwarvish").prop("checked")) ? "Dwarvish \n" : "");
				languages += (($("#langElvish").prop("checked")) ? "Elvish \n" : "");
				languages += (($("#langGiant").prop("checked")) ? "Giant \n" : "");
				languages += (($("#langGnomish").prop("checked")) ? "Gnomish \n" : "");
				languages += (($("#langGoblin").prop("checked")) ? "Goblin \n" : "");
				languages += (($("#langHalfing").prop("checked")) ? "Halfing \n" : "");
				languages += (($("#langOrc").prop("checked")) ? "Orc \n" : "");
				languages += (($("#langAbyssal").prop("checked")) ? "Abyssal \n" : "");
				languages += (($("#langCelestial").prop("checked")) ? "Celestial \n" : "");
				languages += (($("#langDraconic").prop("checked")) ? "Draconic \n" : "");
				languages += (($("#langDeepSpeech").prop("checked")) ? "DeepSpeech \n" : "");
				languages += (($("#langInfernal").prop("checked")) ? "Infernal \n" : "");
				languages += (($("#langPrimordial").prop("checked")) ? "Primordial \n" : "");
				languages += (($("#langSylvan").prop("checked")) ? "Sylvan \n" : "");
				languages += (($("#langUnderCommon").prop("checked")) ? "UnderCommon \n" : "");
				var AC = $("#ac").html();

				var wepnotes = ""
				var wep1 = $($($("#attacksTable").children()).get(0)).children().get(1);
				if (wep1 != null) {
					var wep1Name = $($($($(wep1).children()).get(0)).children().get(0)).val();
					var wep1Bonus = $($($($(wep1).children()).get(1)).children().get(0)).val();
					var wep1Damage = $($($($(wep1).children()).get(3)).children().get(0)).val() + " " + $($($($(wep1).children()).get(2)).children().get(0)).val();
					wepnotes += "1) " + $($($($(wep1).children()).get(4)).children().get(0)).val() + "\n";
				} else {
					var wep1Name = "";
					var wep1Bonus = "";
					var wep1Damage = "";
				}

				var wep2 = $($($("#attacksTable").children()).get(0)).children().get(2);
				if (wep2 != null) {
					var wep2Name = $($($($(wep2).children()).get(0)).children().get(0)).val();
					var wep2Bonus = $($($($(wep2).children()).get(1)).children().get(0)).val();
					var wep2Damage = $($($($(wep2).children()).get(3)).children().get(0)).val() + " " + $($($($(wep2).children()).get(2)).children().get(0)).val();
					wepnotes += "2) " + $($($($(wep1).children()).get(4)).children().get(0)).val() + "\n";
				} else {
					var wep2Name = "";
					var wep2Bonus = "";
					var wep2Damage = "";
				}

				var wep3 = $($($("#attacksTable").children()).get(0)).children().get(3);
				if (wep3 != null) {
					var wep3Name = $($($($(wep3).children()).get(0)).children().get(0)).val();
					var wep3Bonus = $($($($(wep3).children()).get(1)).children().get(0)).val();
					var wep3Damage = $($($($(wep3).children()).get(3)).children().get(0)).val() + " " + $($($($(wep3).children()).get(2)).children().get(0)).val();
					wepnotes += "3) " + $($($($(wep1).children()).get(4)).children().get(0)).val() + "\n";
				} else {
					var wep3Name = "";
					var wep3Bonus = "";
					var wep3Damage = "";
				}

				var speed = 0;
				var traits = "";
				switch (chaRace) {
					case "Dwarf":
						speed = 25;
						break;
					case "Elf":
						speed = 30;
						break;
					case "Halfling":
						speed = 25;
						break;
					case "Human":
						speed = 30;
						break;
					case "Dragonborn":
						speed = 30;
						break;
					case "Gnome":
						speed = 25;
						break;
					case "Half-Elf":
						speed = 30;
						break;
					case "Half-Orc":
						speed = 30;
						break;
					case "Tiefling":
						speed = 30;
						break;
				}


		    	var txt = '<?xml version="1.0" encoding="UTF-8"?> \n';
		    	txt += '<fields xmlns:xfdf="http://ns.adobe.com/xfdf-transition/"> \n';
		    	txt += '<CharacterName>' + charName + '</CharacterName> \n';
		    	txt += '<ClassLevel>' + charClass + charLevel + '</ClassLevel> \n';
		    	txt += '<Background>' + background + '</Background> \n';
		    	//txt += '<PlayerName>Enter your name</PlayerName> \n';
		    	txt += '<Race xfdf:original="Race ">' + chaRace + '</Race> \n';
		    	txt += '<Alignment>' + alignment + '</Alignment> \n';
		    	//txt += '<XP>xp</XP> \n';
		    	txt += '<STR>' + charStr + '</STR> \n';
		    	txt += '<STRmod>' + charStrMod + '</STRmod> \n';
		    	txt += '<DEX>' + charDex + '</DEX> \n';
		    	txt += '<DEXmod xfdf:original="DEXmod ">' + charDexMod + '</DEXmod> \n';
		    	txt += '<CON>' + charCon + '</CON> \n';
		    	txt += '<CONmod>' + charConMod + '</CONmod> \n';
		    	txt += '<INT>' + charInt + '</INT> \n';
		    	txt += '<INTmod>' + charIntMod + '</INTmod> \n';
		    	txt += '<WIS>' + charWis + '</WIS> \n';
		    	txt += '<WISmod>' + charWisMod + '</WISmod> \n';
		    	txt += '<CHA>' + charCha + '</CHA> \n';
		    	txt += '<CHamod>' + charChaMod + '</CHamod> \n';
		    	//txt += '<Inspiration>insp</Inspiration> \n';
		    	txt += '<ProfBonus>' + profBonus + '</ProfBonus> \n';
		    	txt += '<CheckBox11 xfdf:original="Check Box 11">' + STRSaveCheck + '</CheckBox11> \n';
		    	txt += '<STStrength xfdf:original="ST Strength">' + STRSave + '</STStrength> \n';
		    	txt += '<CheckBox18 xfdf:original="Check Box 18">' + DEXSaveCheck + '</CheckBox18> \n';
		    	txt += '<STDexterity xfdf:original="ST Dexterity">' + DEXSave + '</STDexterity> \n';
		    	txt += '<CheckBox19 xfdf:original="Check Box 19">' + CONSaveCheck + '</CheckBox19> \n';
		    	txt += '<STConstitution xfdf:original="ST Constitution">' + CONSave + '</STConstitution> \n';
		    	txt += '<CheckBox20 xfdf:original="Check Box 20">' + INTSaveCheck + '</CheckBox20> \n';
		    	txt += '<STIntelligence xfdf:original="ST Intelligence">' + INTSave + '</STIntelligence> \n';
		    	txt += '<CheckBox21 xfdf:original="Check Box 21">' + WISSaveCheck + '</CheckBox21> \n';
		    	txt += '<STWisdom xfdf:original="ST Wisdom">' + WISSave + '</STWisdom> \n';
		    	txt += '<CheckBox22 xfdf:original="Check Box 22">' + CHASaveCheck + '</CheckBox22> \n';
		    	txt += '<STCharisma xfdf:original="ST Charisma">' + CHASave + '</STCharisma> \n';
		    	txt += '<CheckBox23 xfdf:original="Check Box 23">' + AcrobaticsProf + '</CheckBox23> \n';
		    	txt += '<Acrobatics>' + Acrobatics + '</Acrobatics> \n';
		    	txt += '<CheckBox24 xfdf:original="Check Box 24">' + AnimalProf + '</CheckBox24> \n';
		    	txt += '<Animal>' + Animal + '</Animal> \n';
		    	txt += '<CheckBox25 xfdf:original="Check Box 25">' + ArcanaProf + '</CheckBox25> \n';
		    	txt += '<Arcana>' + Arcana + '</Arcana> \n';
		    	txt += '<CheckBox26 xfdf:original="Check Box 26">' + AthleticsProf + '</CheckBox26> \n';
		    	txt += '<Athletics>' + Athletics + '</Athletics> \n';
		    	txt += '<CheckBox27 xfdf:original="Check Box 27">' + DeceptionProf + '</CheckBox27> \n';
		    	txt += '<Deception xfdf:original="Deception ">' + Deception + '</Deception> \n';
		    	txt += '<CheckBox28 xfdf:original="Check Box 28">' + HistoryProf + '</CheckBox28> \n';
		    	txt += '<History xfdf:original="History ">' + History + '</History> \n';
		    	txt += '<CheckBox29 xfdf:original="Check Box 29">' + InsightProf + '</CheckBox29> \n';
		    	txt += '<Insight>' + Insight + '</Insight> \n';
		    	txt += '<CheckBox30 xfdf:original="Check Box 30">' + IntimidationProf + '</CheckBox30> \n';
		    	txt += '<Intimidation>' + Intimidation + '</Intimidation> \n';
		    	txt += '<CheckBox31 xfdf:original="Check Box 31">' + InvestigationProf + '</CheckBox31> \n';
		    	txt += '<Investigation xfdf:original="Investigation ">' + Investigation + '</Investigation> \n';
		    	txt += '<CheckBox32 xfdf:original="Check Box 32">' + MedicineProf + '</CheckBox32> \n';
		    	txt += '<Medicine>' + Medicine + '</Medicine> \n';
		    	txt += '<CheckBox33 xfdf:original="Check Box 33">' + NatureProf + '</CheckBox33> \n';
		    	txt += '<Nature>' + Nature + '</Nature> \n';
		    	txt += '<CheckBox34 xfdf:original="Check Box 34">' + PerceptionProf + '</CheckBox34> \n';
		    	txt += '<Perception xfdf:original="Perception ">' + Perception + '</Perception> \n';
		    	txt += '<CheckBox35 xfdf:original="Check Box 35">' + PerformanceProf + '</CheckBox35> \n';
		    	txt += '<Performance>' + Performance + '</Performance> \n';
		    	txt += '<CheckBox36 xfdf:original="Check Box 36">' + PersuasionProf + '</CheckBox36> \n';
		    	txt += '<Persuasion>' + Persuasion + '</Persuasion> \n';
		    	txt += '<CheckBox37 xfdf:original="Check Box 37">' + ReligionProf + '</CheckBox37> \n';
		    	txt += '<Religion>' + Religion + '</Religion> \n';
		    	txt += '<CheckBox38 xfdf:original="Check Box 38">' + SleightProf + '</CheckBox38> \n';
		    	txt += '<SleightofHand>' + Sleight + '</SleightofHand> \n';
		    	txt += '<CheckBox39 xfdf:original="Check Box 39">' + StealthProf + '</CheckBox39> \n';
		    	txt += '<Stealth xfdf:original="Stealth ">' + Stealth + '</Stealth> \n';
		    	txt += '<CheckBox40 xfdf:original="Check Box 40">' + SurvivalProf + '</CheckBox40> \n';
		    	txt += '<Survival>' + Survival + '</Survival> \n';
		    	txt += '<Passive>' + (parseInt(Perception) + 10) + '</Passive> \n';
				txt += '<ProficienciesLang>' + languages + '</ProficienciesLang> \n';
		    	txt += '<AC>' + AC + '</AC> \n';

		    	txt += '<Initiative>' + charDexMod + '</Initiative> \n';
		    	txt += '<Speed>' + speed + '</Speed> \n';
		    	//txt += '<HPMax>hpmax</HPMax> \n';
		    	//txt += '<HPCurrent>hpcurr</HPCurrent> \n';
		    	//txt += '<HPTemp>temp hp</HPTemp> \n';
		    	//txt += '<HDTotal>HD tot</HDTotal> \n';
		    	//txt += '<HD>HD curr</HD> \n';
		    	//txt += '<CheckBox12 xfdf:original="Check Box 12">Off</CheckBox12>'; //death success \n 1
		    	//txt += '<CheckBox13 xfdf:original="Check Box 13">Off</CheckBox13>'; //death success \n 2
		    	//txt += '<CheckBox14 xfdf:original="Check Box 14">Off</CheckBox14>'; //death success \n 3
		    	//txt += '<CheckBox15 xfdf:original="Check Box 15">Off</CheckBox15>'; //death fail \n 1
		    	//txt += '<CheckBox16 xfdf:original="Check Box 16">Off</CheckBox16>'; //death fail \n 2
		    	//txt += '<CheckBox17 xfdf:original="Check Box 17">Off</CheckBox17>'; //death fail \n 3
		    	txt += '<WpnName xfdf:original="Wpn Name">' + wep1Name + '</WpnName> \n';
		    	txt += '<Wpn1AtkBonus xfdf:original="Wpn1 AtkBonus">' + wep1Bonus + '</Wpn1AtkBonus> \n';
		    	txt += '<Wpn1Damage xfdf:original="Wpn1 Damage">' + wep1Damage + '</Wpn1Damage> \n';
		    	txt += '<WpnName2 xfdf:original="Wpn Name 2">' + wep2Name + '</WpnName2> \n';
		    	txt += '<Wpn2AtkBonus xfdf:original="Wpn2 AtkBonus ">' + wep2Bonus + '</Wpn2AtkBonus> \n';
		    	txt += '<Wpn2Damage xfdf:original="Wpn2 Damage ">' + wep2Damage + '</Wpn2Damage> \n';
		    	txt += '<WpnName3 xfdf:original="Wpn Name 3">' + wep3Name + '</WpnName2> \n';
		    	txt += '<Wpn3AtkBonus xfdf:original="Wpn3 AtkBonus  ">' + wep3Bonus + '</Wpn2AtkBonus> \n';
		    	txt += '<Wpn3Damage xfdf:original="Wpn3 Damage ">' + wep3Damage + '</Wpn2Damage> \n';
		    	txt += '<AttacksSpellcasting>' + wepnotes + '</AttacksSpellcasting> \n';
		    	//txt += '<CP>CP</CP> \n';
		    	//txt += '<SP>SP</SP> \n';
		    	//txt += '<EP>EP</EP> \n';
		    	//txt += '<GP>GP</GP> \n';
		    	//txt += '<PP>PP</PP> \n';
		    	//txt += '<Equipment>equip</Equipment> \n';

		    	//txt += '<PersonalityTraits xfdf:original="PersonalityTraits ">per trait</PersonalityTraits> \n';
		    	//txt += '<Ideals>ideals</Ideals> \n';
		    	//txt += '<Bonds>bonds</Bonds> \n';
		    	//txt += '<Flaws>flaws</Flaws> \n';
		    	//txt += '<FeaturesandTraits xfdf:original="Features and Traits">feats and traits </FeaturesandTraits> \n';

		    	txt += '</fields> \n';

		    	sender.href = 'data:xml/plain;charset=utf-8,' + encodeURIComponent(txt);
		    }
		</script> 

		<title>DND TOOLS</title> 
	</head>
	<link rel="stylesheet" type="text/css" href="DNDStyle.css">
	<body>
		<div Id = "Header1">
			<!-- import header goes here -->
		</div>
		<div Class = "sickdragonimg_ph">
		</div>
		<div class= "body_content">
			<div class= "PH_ads">
				<p>w/e here</p>
			</div>
			<div class= "PH_main_content" id="main" style="height:auto">
				<div>
					<h1>Character Helper</h1>
					<a href="" id="link" onclick="exportChar(this)" download="Character.xml">Export</a>	<br />
					<label>Name:</label>
					<input type="text" id="charName"></input><br />
					<label>Race:</label>
					<select id="charRace">
					  <option value="None">None</option>
					  <option value="Dwarf">Dwarf</option>
					  <option value="Elf">Elf</option>
					  <option value="Halfing">Halfling</option>
					  <option value="Human">Human</option>
					  <option value="Dragonborn">Dragonborn</option>
					  <option value="Gnome">Gnome</option>
					  <option value="Half-Elf">Half-Elf</option>
					  <option value="Half-Orc">Half-Orc</option>
					  <option value="Tiefling">Tiefling</option>
					</select>
					<span>custom:</span>
					<input type="text" id="charRaceCustom"></input><br />
					
					<span id="classes">
					<span name="class">
					<label>Class</label>
					<select name="charClass">
					  <option value="None">None</option>
					  <option value="Barbarian">Barbarian</option>
					  <option value="Bard">Bard</option>
					  <option value="Cleric">Cleric</option>
					  <option value="Druid">Druid</option>
					  <option value="Fighter">Fighter</option>
					  <option value="Monk">Monk</option>
					  <option value="Paladin">Paladin</option>
					  <option value="Ranger">Ranger</option>
					  <option value="Rogue">Rogue</option>
					  <option value="Sorcerer">Sorcerer</option>
					  <option value="Warlock">Warlock</option>
					  <option value="Wizard">Wizard</option>
					</select>
					<span>level:</span>
					<input type="text" id="charLvl1"></input>
					<br />
					</span>
					</span>
					<button id = "multiClassCheck" onclick="addClass()">Add Class</button>
					<br />
					<label>Alignment:</label>
					<table Class = "alignmentTable">
					  <tr>
						<td><input name ="alignment"  type = "radio" id = "LGradio" value="Lawful Good">Lawful Good</input></td>
						<td><input name ="alignment"  type = "radio" id = "NGradio" value="Neutral Good">Neutral Good</input></td>
						<td><input name ="alignment"  type = "radio" id = "CGradio" value="Chaotic Good">Chaotic Good</input></td>
					  </tr>
					  <tr>
						<td><input name ="alignment"  type = "radio" id = "LNradio" value="Lawful Neutral">Lawful Neutral</input></td>
						<td><input name ="alignment"  type = "radio" id = "TNradio" value="True Neutral">True Neutral</input></td>
						<td><input name ="alignment"  type = "radio" id = "CNradio" value="Chaotic Neutral">Chaotic Neutral</input></td>
					  </tr>
					  <tr>
						<td><input name ="alignment"  type = "radio" id = "LEradio" value="Lawful Evil">Lawful Evil</input></td>
						<td><input name ="alignment"  type = "radio" id = "NEradio" value="Neutral Evil">Neutral Evil</input></td>
						<td><input name ="alignment"  type = "radio" id = "CLradio" value="Chaotic Evil">Chaotic Evil</input></td>
					  </tr>
					</table>
					<label>Stastistics:</label><br />
					<table Class = "statsTable" id="statsTable">
					  <tr>
						<td><input type="text" id="charSTR" oninput="calcMod(this)">Strength</input></td>
						<td><input type="text" id="charDEX" oninput="calcMod(this)">Dexterity</input></td>
						<td><input type="text" id="charCON" oninput="calcMod(this)">Constitution</input></td>
						<td><input type="text" id="charINT" oninput="calcMod(this)">Intelligence</input></td>
						<td><input type="text" id="charWIS" oninput="calcMod(this)">Wisdom</input></td>
						<td><input type="text" id="charCHA" oninput="calcMod(this)">Charisma</input></td>
					  </tr>
					  <tr>
						<td><label id ="STRmod">0</label></td>
						<td><label id ="DEXmod">0</label></td>
						<td><label id ="CONmod">0</label></td>
						<td><label id ="INTmod">0</label></td>
						<td><label id ="WISmod">0</label></td>
						<td><label id ="CHAmod">0</label></td>	
					  </tr>
					</table>
					<label>Saving Throws</label><br />
					<input name ="savingThrows"  type ="checkbox" id="charSTRsavethrow">Strength</input>
					<input name ="savingThrows"  type ="checkbox" id="charDEXsavethrow">Dexterity</input>
					<input name ="savingThrows"  type ="checkbox" id="charCONsavethrow">Constitution</input>
					<input name ="savingThrows"  type ="checkbox" id="charINTsavethrow">Intelligence</input>
					<input name ="savingThrows"  type ="checkbox" id="charWISsavethrow">Wisdom</input>
					<input name ="savingThrows"  type ="checkbox" id="charCHAsavethrow">Charisma</input><br />
					<label>proficiencies<span id="profChoices"> </span><span id="profChosen"> </span></label><br />
					<ul class = "doublelist" id="proficienciesList">
						<li><input name ="proficiencies" value="Acrobatics" type ="checkbox" id="profAcrobatics" onchange="countSkillChoices()">Acrobatics(Dex)</input></li>
						<li><input name ="proficiencies" value="Animal Handling" type ="checkbox" id="profAnimalHandling" onchange="countSkillChoices()">Animal Handling(Wis)</input></li>
						<li><input name ="proficiencies" value="Arcana" type ="checkbox" id="profArcana" onchange="countSkillChoices()">Arcana(Int)</input></li>
						<li><input name ="proficiencies" value="Athletics" type ="checkbox" id="profAthletics" onchange="countSkillChoices()">Athletics(Str)</input></li>
						<li><input name ="proficiencies" value="Deception" type ="checkbox" id="profDeception" onchange="countSkillChoices()">Deception(Cha)</input></li>
						<li><input name ="proficiencies" value="History" type ="checkbox" id="profHistory" onchange="countSkillChoices()">History(Int)</input></li>
						<li><input name ="proficiencies" value="Insight" type ="checkbox" id="profInsight" onchange="countSkillChoices()">Insight(Wis)</input></li>
						<li><input name ="proficiencies" value="Intimidation" type ="checkbox" id="profIntimidation" onchange="countSkillChoices()">Intimidation(Cha)</input></li>
						<li><input name ="proficiencies" value="Investigation" type ="checkbox" id="profInvestigation" onchange="countSkillChoices()">Investigation(Int)</input></li>
						<li><input name ="proficiencies" value="Medicine" type ="checkbox" id="profMedicine" onchange="countSkillChoices()">Medicine(Wis)</input></li>
						<li><input name ="proficiencies" value="Nature" type ="checkbox" id="profNature" onchange="countSkillChoices()">Nature(Int)</input></li>
						<li><input name ="proficiencies" value="Perception" type ="checkbox" id="profPerception" onchange="countSkillChoices()">Perception(Wis)</input></li>
						<li><input name ="proficiencies" value="Performance" type ="checkbox" id="profPerformance" onchange="countSkillChoices()">Performance(Cha)</input></li>
						<li><input name ="proficiencies" value="Persuasion" type ="checkbox" id="profPersuasion" onchange="countSkillChoices()">Persuasion(Cha)</input></li>
						<li><input name ="proficiencies" value="Religion" type ="checkbox" id="profReligion" onchange="countSkillChoices()">Religion(Int)</input></li>
						<li><input name ="proficiencies" value="Sleight Of Hand" type ="checkbox" id="profSleightOfHand" onchange="countSkillChoices()">Sleight Of Hand(Dex)</input></li>
						<li><input name ="proficiencies" value="Stealth" type ="checkbox" id="profStealth" onchange="countSkillChoices()">Stealth(Dex)</input></li>
						<li><input name ="proficiencies" value="Survival" type ="checkbox" id="profSurvival" onchange="countSkillChoices()">Survival(Wis)</input></li>
					</ul>
					<label>languages<span id="langChoices"> </span><span id="langChosen"> </span></label><br />
					<ul class = "doublelist" id="languagesList">
						<li><input name ="languages" value="Common" type ="checkbox" id="langCommon" onchange="countLanguageChoices()">Common</input></li>
						<li><input name ="languages" value="Dwarvish" type ="checkbox" id="langDwarvish" onchange="countLanguageChoices()">Dwarvish</input></li>
						<li><input name ="languages" value="Elvish" type ="checkbox" id="langElvish" onchange="countLanguageChoices()">Elvish</input></li>
						<li><input name ="languages" value="Giant" type ="checkbox" id="langGiant" onchange="countLanguageChoices()">Giant</input></li>
						<li><input name ="languages" value="Gnomish" type ="checkbox" id="langGnomish" onchange="countLanguageChoices()">Gnomish</input></li>
						<li><input name ="languages" value="Goblin" type ="checkbox" id="langGoblin" onchange="countLanguageChoices()">Goblin</input></li>
						<li><input name ="languages" value="Halfling" type ="checkbox" id="langHalfing" onchange="countLanguageChoices()">Halfling</input></li>
						<li><input name ="languages" value="Orc" type ="checkbox" id="langOrc" onchange="countLanguageChoices()">Orc</input></li>
						<li><input name ="languages" value="Abyssal" type ="checkbox" id="langAbyssal" onchange="countLanguageChoices()">Abyssal</input></li>
						<li><input name ="languages" value="Celestial" type ="checkbox" id="langCelestial" onchange="countLanguageChoices()">Celestial</input></li>
						<li><input name ="languages" value="Draconic" type ="checkbox" id="langDraconic" onchange="countLanguageChoices()">Draconic</input></li>
						<li><input name ="languages" value="Deep Speech" type ="checkbox" id="langDeepSpeech" onchange="countLanguageChoices()">Deep Speech</input></li>
						<li><input name ="languages" value="Infernal" type ="checkbox" id="langInfernal" onchange="countLanguageChoices()">Infernal</input></li>
						<li><input name ="languages" value="Primordial" type ="checkbox" id="langPrimordial" onchange="countLanguageChoices()">Primordial</input></li>
						<li><input name ="languages" value="Sylvan" type ="checkbox" id="langSylvan" onchange="countLanguageChoices()">Sylvan</input></li>
						<li><input name ="languages" value="UnderCommon" type ="checkbox" id="langUnderCommon" onchange="countLanguageChoices()">UnderCommon</input></li>
					</ul>
					<label>Background</label><br />
					<select id="backgrounds" onchange="setBackground()">
					  <option value="None">None</option>
					  <option value="Acolyte">Acolyte</option>
					  <option value="Charlatan">Charlatan</option>
					  <option value="Criminal">Criminal</option>
					  <option value="Entertainer">Entertainer</option>
					  <option value="Folk Hero">Folk Hero</option>
					  <option value="Guild Artisan">Guild Artisan</option>
					  <option value="Hermit">Hermit</option>
					  <option value="Noble">Noble</option>
					  <option value="Outlander">Outlander</option>
					  <option value="Sage">Sage</option>
					  <option value="Sailor">Sailor</option>
					  <option value="Soldier">Soldier</option>
					  <option value="Urchin">Urchin</option>
					  <option value="Custom">Custom</option>
					</select>
					<br />
					<label>Traits</label><br />
					<span id="backgroundText"> </span>
					<span id="featsText"> </span>
					<br />
					<label>Feats</label><br />
					<select id="feats">
					  <option value="Alert">Alert</option>
					  <option value="Athlete">Athlete</option>
					  <option value="Actor">Actor</option>
					  <option value="Charger">Charger</option>
					  <option value="Crossbow Expert">Crossbow Expert</option>
					  <option value="Defensive Duelist">Defensive Duelist</option>
					  <option value="Dual Wielder">Dual Wielder</option>
					  <option value="Dungeon Delver">Dungeon Delver</option>
					  <option value="Durable">Durable</option>
					  <option value="Elemental Adept">Elemental Adept</option>
					  <option value="Grappler">Grappler</option>
					  <option value="Great Weapons Master">Great Weapons Master</option>
					  <option value="Healer">Healer</option>
					  <option value="Heavily Armored">Heavily Armored</option>
					  <option value="Heavy Armor Master">Heavy Armor Master</option>
					  <option value="Inspiring Leader">Inspiring Leader</option>
					  <option value="Keen Mind">Keen Mind</option>
					  <option value="Lightly Armored">Lightly Armored</option>
					  <option value="Linguist">Linguist</option>
					  <option value="Lucky">Lucky</option>
					  <option value="Mage Slayer">Mage Slayer</option>
					  <option value="Magic Initiate">Magic Initiate</option>
					  <option value="Martial Adept">Martial Adept</option>
					  <option value="Medium Armor Master">Medium Armor Master</option>
					  <option value="Mobile">Mobile</option>
					  <option value="Moderately Armored">Moderately Armored</option>
					  <option value="Mounted Combatant">Mounted Combatant</option>
					  <option value="Observant">Observant</option>
					  <option value="Polearm Master">Polearm Master</option>
					  <option value="Resilient">Resilient</option>
					  <option value="Ritual Caster">Ritual Caster</option>
					  <option value="Savage Attacker">Savage Attacker</option>
					  <option value="Sentinel">Sentinel</option>
					  <option value="Sharpshooter">Sharpshooter</option>
					  <option value="Shield Master">Shield Master</option>
					  <option value="Skilled">Skilled</option>
					  <option value="Skulker">Skulker</option>
					  <option value="Spell Sniper">Spell Sniper</option>
					  <option value="Tavern Brawler">Tavern Brawler</option>
					  <option value="Tough">Tough</option>
					  <option value="War Caster">War Caster</option>
					  <option value="Weapon Master">Weapon Master</option>
					</select>
					<button onclick="addFeat()">Add Feat</button>
					<br />
					<label>AC </label><br /> 
					<label>Armour </label>
					<select id="armour" onchange="calcAC()">
					  <option value="10-Dex">No Armour</option>
					  <option value="11-Dex">Padded</option>
					  <option value="11-Dex">Leather</option>
					  <option value="12-Dex">Studded Leather</option>
					  <option value="12-Dex-2">Hide</option>
					  <option value="13-Dex-2">Chain Shirt</option>
					  <option value="14-Dex-2">Scale Mail</option>
					  <option value="14-Dex-2">Breastplate</option>
					  <option value="15-Dex-2">Half Plate</option>
					  <option value="14">Ring Mail</option>
					  <option value="16">Chain Mail</option>
					  <option value="17">Splint</option>
					  <option value="18">Plate</option>
					</select>
					<br />
					<label>total AC </label><span id="ac">10</span>
					<br />
					<label>Attacks</label><br />
					<table Class = "attacksTable" id="attacksTable">
					  <tr>
						<th><span>Name</span></th>
						<th><span>Attack Bonus</span></th>
						<th><span>Damange Type</span></th>
						<th><span>Damage</span></th>
						<th><span>Aditional Details</span></th>
						<th><button onclick="addAttack()">Add New Attack</button></th>
					  </tr>
					  <tr>
						<td><input name="attName"></input></td>
						<td><input name="attBonus"></input></td>
						<td><input name="attType"></input></td>
						<td><input name="attDmg"></input></td>
						<td><input name="attDetails"></input></td>
						<td><button id="remove_but" type="button" onclick="removeAttack(this)">Remove</button></td>
					  </tr>
					</table>				
				</div>
			</div>
			<div class= "PH_modules_list" id="PH_modules_list">
			</div>
		</div>
		<div class = "footer">
			<div class ="navbar">
				<p>Navbar</p>
			</div>
		</div>
	</body>
</html>